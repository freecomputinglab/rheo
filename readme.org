#+ATTR_HTML: :alt Project header :align center :width 600px
[[./header.png]]

rheo is a static site and experimental typesetting engine based on Typst that compiles entire folders of Typst documents to PDF, HTML, and EPUB simultaneously. It provides first-class support for both HTML and PDF with experimental EPUB support, and includes a development server for rapid HTML iteration.

** Usage
rheo is a command-line tool for batch-compiling Typst documents to multiple output formats.

*** Start developing a project

Compile all =.typ= files in a directory to PDF, HTML, and EPUB:

#+begin_src bash
rheo watch examples/blog_site --open
#+end_src

Compile to specific formats:

#+begin_src bash
# PDF only
rheo compile examples/blog_site --pdf

# HTML only
rheo compile examples/blog_site --html
#+end_src

Output is organized in each project's =build= directory: =build/pdf/= and =build/html/=.

*** Clean Build Artifacts

Remove build artifacts:

#+begin_src bash
# For current directory
rheo clean

# For a specific project
rheo clean examples/web_book
#+end_src

*** Logging

Control output verbosity:

#+begin_src bash
# Quiet mode (errors only)
rheo compile examples/web_book --quiet

# Verbose mode (debug information)
rheo compile examples/web_book --verbose

# Trace-level logging
RUST_LOG=rheo=trace rheo compile examples/web_book
#+end_src

** Installation

*** Using cargo (Recommended)
rheo requires Rust and Cargo. Install from [[https://rustup.rs/][rustup.rs]].

#+begin_src bash
# Build the project
cargo build --release

# Install locally
cargo install --path .
#+end_src


*** Using Nix flakes
To install the compilation environment, first ensure that you have [[https://nixos.org/download/][Nix]] installed on your computer.
You will also need to enable [[https://nixos.wiki/wiki/Flakes][Nix flakes]], which you can do by inserting the following line in your ~nix.conf~:

#+begin_src conf
experimental-features = nix-command flakes
#+end_src

With Nix and flakes installed, run:

#+begin_src bash
# Enter development environment
nix develop

# Or build the package
nix build
#+end_src

This might take a while the first time, as Nix is installing typst from upstream and all the other necessary software.

** Link Transformation

rheo automatically transforms cross-document links based on the output format to ensure they work correctly in each context.

Relative =.typ= links are handled as follows:
- **PDF**: Removed from output, preserving only the link text (since Typst files won't exist output)
- **HTML**: Transformed to =.html= links with validation that linked files exist and are within project boundaries
- **External links** (HTTP, HTTPS, mailto): Preserved identically in all formats
- **Fragment links** (anchors within the same document): Preserved in all formats

Example Typst source:

#+begin_src typst
See the #link("./about.typ")[about page] for more information.
Visit #link("https://example.com")[our website].
#+end_src

Compiles to PDF as: "See the about page for more information. Visit our website."

Compiles to HTML as: `See the <a href="./about.html">about page</a> for more information. Visit <a href="https://example.com">our website</a>.`

If a linked file doesn't exist, rheo will report a detailed error during compilation.
